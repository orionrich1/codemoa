<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/default_layout}">
	
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>  
</head>

<th:block layout:fragment="content">
	<style>
		/* 그림자 잘림 방지를 위한 Swiper 컨테이너 패딩 */
		.mySwiper {
			padding-top: 10px;
			padding-bottom: 30px;
		}
		/* 카드 스타일 */
		.item-gallery-card {
			background-color: var(--surface-default);
			border-radius: var(--border-radius-lg);
			box-shadow: var(--shadow-sm);
			height: 100%;
			display: flex;
			flex-direction: column;
			transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
		}
		.item-gallery-card:hover {
			transform: translateY(-5px);
			box-shadow: var(--shadow-md);
		}
		/* 이미지 잘림 방지 */
		.item-cover-image {
			width: 100%;
			height: 250px;
			object-fit: contain; 
		}
		/* Flexbox를 이용한 텍스트 하단 정렬 */
		.item-texts {
			padding: 1rem;
			flex-grow: 1;
			display: flex;
			flex-direction: column;
		}
		.item-texts strong {
			font-weight: var(--font-weight-bold);
			display: -webkit-box;
			-webkit-line-clamp: 2;
			-webkit-box-orient: vertical;
			overflow: hidden;
			text-overflow: ellipsis;
			min-height: 2.5em; 
			flex-grow: 1; 
		}
		.item-texts .metadata {
			font-size: 1.4rem; /* 14px */
			color: var(--text-secondary);
			margin-top: 0.75rem;
		}
		.item-texts .metadata span {
			display: block;
		}
		/* 호버 오버레이 */
		.item-hover-overlay {
			position: absolute; top: 0; left: 0; width: 100%; height: 100%;
			background-color: rgba(var(--bs-dark-rgb), 0.7);
			color: var(--text-inverse);
			padding: 1.5rem;
			opacity: 0;
			transition: opacity 0.3s ease;
			display: flex; align-items: center; justify-content: center; text-align: center;
		}
		.item-gallery-card a:hover .item-hover-overlay {
			opacity: 1;
		}
		.item-hover-content {
			font-size: 1.4rem; /* 14px */
			display: -webkit-box;
			-webkit-line-clamp: 10;
			-webkit-box-orient: vertical;
			overflow: hidden;
		}
	</style>
	
	<main class="container my-5">
		<div class="text-center mb-4">
			<h2 class="fw-bold fs-2">강좌 추천</h2>
		</div>

		<div class="d-flex justify-content-end align-items-center mb-4">
			<div class="d-flex align-items-center gap-2">
				<form class="d-flex" role="search" id="lectureSearchForm">
					<input class="form-control" type="search" name="keyword" placeholder="강좌명 검색" style="min-width: 200px;" id="lectureSearch" th:value="${#strings.isEmpty(keyword) or keyword == 'null' ? '' : keyword}">
					<input type="hidden" name="type" id="type">
				</form>
				<th:block th:if="${order == 'regDate'}">
					<select name="order" id="typeSelector1" class="form-select">
						<option value="recommendNo">기존 순서</option>
						<option value="rating">평점</option>
						<option value="regDate" selected>등록일</option>
					</select>
				</th:block>
				<th:block th:if="${order == 'rating'}">
					<select name="order" id="typeSelector1" class="form-select">
						<option value="recommendNo">기존 순서</option>
						<option value="rating" selected>평점</option>
						<option value="regDate">등록일</option>
					</select>
				</th:block>
				<th:block th:if="${order != 'regDate' and order != 'rating'}">
					<select name="order" id="typeSelector1" class="form-select">
						<option value="recommendNo" disabled selected>정렬기준</option>
						<option value="recommendNo">기존 순서</option>
						<option value="rating">평점</option>
						<option value="regDate">등록일</option>
					</select>
				</th:block>
				<a th:href="@{lectureAdd}" class="btn btn-primary flex-shrink-0">글쓰기</a>
			</div>
		</div>

		<div class="swiper mySwiper">
			<div class="swiper-wrapper" id="content">
		
				<th:block th:each="lecture: ${lList}">
					<div class="swiper-slide">
						<div class="item-gallery-card">
							<a th:href="@{/information/lectureDetail(no=${lecture.recommendNo}, pageNum=${currentPage}, order=${order}, keyword=${keyword})}">
								<img th:src="@{/resources/files/information/{img}(img=${lecture.file1})}" alt="이미지" class="item-cover-image">
								<div class="item-hover-overlay">
									<div class="item-hover-content">
										[[${lecture.subtitle}]]
									</div>
								</div>
							</a>
							<div class="item-texts">
								<strong>[[${lecture.title}]]</strong>
								<div class="metadata">
									<span><b class="fw-bold">평점:</b> [[${lecture.rating}]]</span>
									<span><b class="fw-bold">작성자:</b> [[${lecture.userId}]]</span>
								</div>
							</div>
						</div>
					</div>
				</th:block>
				
			</div>
		</div>

		<div class="row mt-5" id="Row">
			<div class="col">
				<nav th:if="${order != null and not #lists.isEmpty(lList)}" aria-label="Page navigation">
					<ul class="pagination justify-content-center">
						<li class="page-item" th:if="${startPage > pageGroup}"><a class="page-link" th:href="@{|lecture?pageNum=${startPage-1}&order=${order}&keyword=${keyword}|}">Pre</a></li>
						<li th:each="num : ${#numbers.sequence(startPage, endPage)}" th:classappend="${num == currentPage} ? 'active'" class="page-item"><a class="page-link" th:href="@{|lecture?pageNum=${num}&order=${order}&keyword=${keyword}|}" th:text="${num}"></a></li>
						<li class="page-item" th:if="${endPage < pageCount}"><a class="page-link" th:href="@{|lecture?pageNum=${startPage+pageGroup}&order=${order}&keyword=${keyword}|}">Next</a></li>
					</ul>
				</nav>
				<nav th:if="${order == null and not #lists.isEmpty(lList)}" aria-label="Page navigation">
					<ul class="pagination justify-content-center">
						<li class="page-item" th:if="${startPage > pageGroup}"><a class="page-link" th:href="@{|lecture?pageNum=${startPage-1}&keyword=${keyword}|}">Pre</a></li>
						<li th:each="num : ${#numbers.sequence(startPage, endPage)}" th:classappend="${num == currentPage} ? 'active'" class="page-item"><a class="page-link" th:href="@{|lecture?pageNum=${num}&keyword=${keyword}|}" th:text="${num}"></a></li>
						<li class="page-item" th:if="${endPage < pageCount}"><a class="page-link" th:href="@{|lecture?pageNum=${startPage+pageGroup}&keyword=${keyword}|}">Next</a></li>
					</ul>
				</nav>
			</div>
		</div>
	</main>
</th:block>

<th:block layout:fragment="script">
	<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
	<script th:src="@{/js/information/ajax.js}"></script>
	<script>
		const swiper = new Swiper(".mySwiper", {
			slidesPerView: 1,
			spaceBetween: 30,
			grid: {
				rows: 2,
				fill: "row",
			},
			breakpoints: {
				576: { slidesPerView: 2, grid: { rows: 2, fill: "row" } },
				768: { slidesPerView: 3, grid: { rows: 2, fill: "row" } },
				992: { slidesPerView: 4, grid: { rows: 2, fill: "row" } }
			}
		});
	</script>
</th:block>
	
</html>