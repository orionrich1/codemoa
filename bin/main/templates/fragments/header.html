<div th:fragment="header" xmlns:th="http://www.thymeleaf.org"
     xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <nav class="navbar navbar-expand-lg navbar-light bg-white py-3 shadow-sm">
		<div class="container">

			<a class="navbar-brand" th:href="@{/}">
    <img th:src="@{/images/logo.png}" alt="CodeMoa 로고" style="height: 32px;">
</a>

			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#header-nav-content">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="header-nav-content">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">

						<li class="nav-item dropdown"><a class="nav-link dropdown-toggle fw-bold" href="#" role="button" data-bs-toggle="dropdown">AI 코딩</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" th:href="@{/problems}">AI 코딩 문제</a></li>
							<li><a class="dropdown-item" th:href="@{/problems/aiAnswer}">AI 답변 받기</a></li>
						</ul></li>


					<li class="nav-item dropdown"><a class="nav-link dropdown-toggle fw-bold" href="#" role="button" data-bs-toggle="dropdown">커뮤니티</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" th:href="@{/ranking}">랭킹</a></li>
							<li><a class="dropdown-item" th:href="@{/community/free}">자유게시판</a></li>
							<li><hr class="dropdown-divider"></li>
							<li><h6 class="dropdown-header">언어 게시판</h6></li>
							<li><a class="dropdown-item" href="/chat/rooms">채팅방</a></li>
							<li><a class="dropdown-item" th:href="@{/community/Java}">Java</a></li>
							<li><a class="dropdown-item" th:href="@{/community/Python}">Python</a></li>
							<li><a class="dropdown-item" th:href="@{/community/JavaScript}">JavaScript</a></li>
							<li><a class="dropdown-item" th:href="@{/community/Kotlin}">Kotlin</a></li>
						</ul></li>

					<li class="nav-item dropdown"><a class="nav-link dropdown-toggle fw-bold" href="#" role="button" data-bs-toggle="dropdown">IT 정보</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" th:href="@{/information/book}">도서 추천</a></li>
							<li><a class="dropdown-item" th:href="@{/information/lecture}">강좌 추천</a></li>
							<li><a class="dropdown-item" th:href="@{/information/contest}">공모전 정보</a></li>
						</ul></li>

					<li class="nav-item dropdown"><a class="nav-link dropdown-toggle fw-bold" href="#" role="button" data-bs-toggle="dropdown">채용 & 팀</a>
						<ul class="dropdown-menu rounded-3">
							<li><a class="dropdown-item" th:href="@{/employmentList}">채용 공고</a></li>
							<li><a class="dropdown-item" th:href="@{/teamRecruitList}">팀원 모집</a></li>
						</ul></li>

					<li class="nav-item dropdown"><a class="nav-link dropdown-toggle fw-bold" href="#" role="button" data-bs-toggle="dropdown">고객센터</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" th:href="@{/support/qna}">Q&A</a></li>
							<li><a class="dropdown-item" th:href="@{/support/faq}">FAQ</a></li>
						</ul></li>
				</ul>

				<form class="d-flex my-2 my-lg-0" role="search" action="/search">
					<div class="input-group">
						<input class="form-control" name="keyword" type="search" placeholder="통합 검색" required>
						<button class="btn btn-outline-secondary" type="submit" style="z-index: 1;">
							<i class="bi bi-search"></i>
						</button>
					</div>
				</form>

				<div class="navbar-nav align-items-center ms-lg-3">
					<div sec:authorize="isAnonymous()">
						<ul class="navbar-nav">
							<li class="nav-item"><a class="nav-link fw-bold" th:href="@{/loginForm}">로그인</a></li>
                            <li class="nav-item ms-2"><a class="btn btn-primary px-3" th:href="@{/joinForm}"><i class="bi bi-person-plus-fill me-1"></i>회원가입</a></li>
						</ul>
					</div>

					<div sec:authorize="isAuthenticated()">
						<ul class="navbar-nav">
							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
									<div th:replace="~{fragments/_userProfile :: userProfile(
										nickname=${#authentication.principal.user.nickname},
										iconName=${#authentication.principal.user.grade.name().toLowerCase()}
									)}"></div>
								</a>
								<ul class="dropdown-menu dropdown-menu-end">
									<li><a class="dropdown-item" href="/my-pages"><i class="bi bi-person-circle me-2"></i>마이페이지</a></li>
									<li><hr class="dropdown-divider"></li>
									
									<th:block sec:authorize="hasRole('ROLE_ADMIN')">
										<li><a class="dropdown-item" href="/admin/users"><i class="bi bi-person-video me-2"></i>유저 관리</a></li>
										<li><hr class="dropdown-divider"></li>
									</th:block>
									
									<li>
										<form th:action="@{/logout}" method="post" class="d-inline">
											<button type="submit" class="dropdown-item"><i class="bi bi-box-arrow-right me-2"></i>로그아웃</button>
										</form>
									</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>

			</div>
		</div>
	</nav>
</div>