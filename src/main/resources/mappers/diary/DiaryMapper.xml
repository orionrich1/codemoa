<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.codemoa.project.domain.diary.mapper.DiaryMapper">

	<select id="getProjectList" resultType="Project">
		SELECT * FROM project WHERE user_id=#{userID} ORDER BY project_id DESC
	</select>
	
	<select id="getProjectDetail" resultType="Project">
		SELECT * FROM project WHERE project_id=#{projectId}
	</select>
	
	
	
	<select id="getProjectCheckList" resultType="ProjectChecklist">
	    SELECT checklist_id,
	           project_id,
	           content,
	           is_done AS done,
	           priority,
	           created_at
	    FROM project_checklist
	    WHERE project_id = #{projectId}
	    ORDER BY checklist_id
	</select>
	
	<update id="updateCheck" parameterType="UpdateCheckStatusRequest">
		UPDATE project_checklist SET is_done=#{done} WHERE checklist_id=#{no}
	</update>
	
	<insert id="addChecklist" parameterType="ChecklistCreateRequest" 
		useGeneratedKeys="true" keyProperty="checklistId">
		INSERT INTO project_checklist (project_id, content, is_done, priority) 
		VALUES (#{projectId}, #{content}, 0, #{priority});
    </insert>
    
    <select id="getNewProjectCheckList" parameterType="ProjectChecklist">
	    SELECT checklist_id,
	           project_id,
	           content,
	           is_done AS done,
	           priority,
	           created_at
	    FROM project_checklist
	    WHERE checklist_id = #{checklist_id}
    </select>
	
	<update id="updateChecklist" parameterType="UpdateChecklistRequest">
		UPDATE project_checklist SET content=#{content}, priority=#{priority} WHERE checklist_id=#{checklistId}
	</update>
	
	<delete id="deleteChecklist">
		DELETE FROM project_checklist WHERE checklist_id=#{checklistId};
	</delete>


	<select id="getProjectdiaries" resultType="ProjectDiary">
		SELECT * FROM project_diary WHERE project_id=#{projectId}
	</select>
</mapper>