<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/default_layout}">
	
	<head>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>  
	</head>
	<th:block layout:fragment="content">
		<style>
			.mySwiper {
				padding-top: 10px;
				padding-bottom: 30px;
			}

			.book-gallery-card {
				background-color: white;
				border-radius: var(--bs-border-radius);
				box-shadow: var(--bs-box-shadow-sm);
				height: 100%;
				display: flex;
				flex-direction: column;
				transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
			}
			.book-gallery-card:hover {
				transform: translateY(-5px);
				box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
			}

			.book-cover-image {
				width: 100%;
				height: 250px;
				object-fit: contain;
			}

			.book-texts {
				padding: 1rem;
				flex-grow: 1;
				display: flex;
				flex-direction: column;
			}
			.book-texts strong {
				font-weight: 700;
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
				overflow: hidden;
				text-overflow: ellipsis;
				min-height: 2.5em;
				flex-grow: 1;
			}
			.book-texts .metadata {
				font-size: 0.85rem;
				color: #495057;
				margin-top: 0.75rem;
			}
			.book-texts .metadata span {
				display: block;
			}

			.book-hover-overlay {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(33, 37, 41, 0.7);
				color: white;
				padding: 1.5rem;
				opacity: 0;
				transition: opacity 0.3s ease;
				display: flex;
				align-items: center;
				justify-content: center;
				text-align: center;
			}
			.book-gallery-card a:hover .book-hover-overlay {
				opacity: 1;
			}
			.book-hover-content {
				font-size: 0.9rem;
				display: -webkit-box;
				-webkit-line-clamp: 10;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}
		</style>

		<main class="container my-5">
			<div class="text-center mb-4">
				<h2 class="fw-bold fs-2">공모전 추천</h2>
			</div>

			<div class="d-flex justify-content-end align-items-center mb-4">
				<div class="d-flex align-items-center gap-2">
					<form class="d-flex" role="search" id="contestSearchForm">
						<input class="form-control" type="search" name="keyword" 
						       placeholder="공모전명 검색" style="min-width: 200px;" id="contestSearch"
						       th:value="${#strings.isEmpty(keyword) or keyword == 'null' ? '' : keyword}" />
						<input type="hidden" name="type" id="type">
					</form>
					<th:block th:if="${order == 'startDate'}">
						<select name="order" id="typeSelector2" class="form-select">
							<option value="contestNo">기존 순서</option>
							<option value="endDate">마감일</option>
							<option value="startDate" selected>시작일</option>
						</select>
					</th:block>
					<th:block th:if="${order == 'endDate'}">
						<select name="order" id="typeSelector2" class="form-select">
							<option value="contestNo">기존 순서</option>
							<option value="endDate" selected>마감일</option>
							<option value="startDate">시작일</option>
						</select>
					</th:block>
					<th:block th:if="${order != 'startDate' and order != 'endDate'}">
						<select name="order" id="typeSelector2" class="form-select">
							<option value="contestNo" disabled selected>정렬기준</option>
							<option value="contestNo">기존 순서</option>
							<option value="endDate">마감일</option>
							<option value="startDate">시작일</option>
						</select>
					</th:block>
					<a th:href="@{contestAdd}" class="btn btn-primary flex-shrink-0">글쓰기</a>
				</div>
			</div>

			<div class="swiper mySwiper">
				<div class="swiper-wrapper" id="content">
				
					<th:block th:each="contest, iterStat : ${cList}">
						<th:block th:if="${iterStat.index < 8}">
							<div class="swiper-slide">
								<div class="book-gallery-card">
									<a th:href="@{/information/contestDetail(no=${contest.contestNo}, pageNum=${currentPage}, order=${order})}">
										<img th:src="@{/resources/files/information/{img}(img=${contest.file1})}" alt="이미지" class="book-cover-image">
										<div class="book-hover-overlay">
											<div class="book-hover-content">
												<p>작성자: [[${contest.userId}]]</p>
												<p>등록일: [[${#dates.format(contest.regDate, 'yyyy-MM-dd')}]]</p>
											</div>
										</div>
									</a>
									<div class="book-texts">
										<strong>[[${contest.title}]]</strong>
										<div class="metadata">
											<span><b>기한:</b> [[${#dates.format(contest.startDate, 'yyyy-MM-dd')}]] ~ [[${#dates.format(contest.endDate, 'yyyy-MM-dd HH:mm')}]]</span>
											<span><b>주최기관:</b> [[${contest.hostOrganization}]]</span>
										</div>
									</div>
								</div>
							</div>
						</th:block>
					</th:block>
					
				</div>
			</div>

			<div class="row mt-5" id="Row">
				<div class="col">
					<nav th:if="${order != null and not #lists.isEmpty(cList)}" aria-label="Page navigation">
						<ul class="pagination justify-content-center">
							<li class="page-item" th:if="${startPage > pageGroup}">
								<a class="page-link" th:href="@{|contest?pageNum=${startPage-1}&order=${order}|}">Pre</a>
							</li>
							<li th:each="num : ${#numbers.sequence(startPage, endPage)}"
							    th:classappend="${num == currentPage} ? 'active'" class="page-item">
								<a class="page-link" th:href="@{|contest?pageNum=${num}&order=${order}|}" th:text="${num}"></a>
							</li>
							<li class="page-item" th:if="${endPage < pageCount}">
								<a class="page-link" th:href="@{|contest?pageNum=${startPage+pageGroup}&order=${order}|}">Next</a>
							</li>
						</ul>
					</nav>
					<nav th:if="${order == null and not #lists.isEmpty(cList)}" aria-label="Page navigation">
						<ul class="pagination justify-content-center">
							<li class="page-item" th:if="${startPage > pageGroup}">
								<a class="page-link" th:href="@{|contest?pageNum=${startPage-1}|}">Pre</a>
							</li>
							<li th:each="num : ${#numbers.sequence(startPage, endPage)}"
							    th:classappend="${num == currentPage} ? 'active'" class="page-item">
								<a class="page-link" th:href="@{|contest?pageNum=${num}|}" th:text="${num}"></a>
							</li>
							<li class="page-item" th:if="${endPage < pageCount}">
								<a class="page-link" th:href="@{|contest?pageNum=${startPage+pageGroup}|}">Next</a>
							</li>
						</ul>
					</nav>
				</div>
			</div>
		</main>
	</th:block>



<th:block layout:fragment="script">
	<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
	<script th:src="@{/js/information/ajax.js}"></script>
	<script>
	const swiper = new Swiper(".mySwiper", {
		  spaceBetween: 30,
		  slidesPerView: 4,
		  grid: {
		    rows: 2,
		    fill: "row"
		  },	
		  pagination: {
		    el: ".swiper-pagination",
		    clickable: true
		  },
		  breakpoints: {
		    0: { slidesPerView: 1, grid: { rows: 8 } },
		    576: { slidesPerView: 2, grid: { rows: 4 } },
		    768: { slidesPerView: 3, grid: { rows: 3 } },
		    992: { slidesPerView: 4, grid: { rows: 2 } }
		  }
		});

	</script>
</th:block>
	
</html>
		  