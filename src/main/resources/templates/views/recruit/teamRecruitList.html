<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default_layout}">

<div layout:fragment="content">
    <style>
        .recruit-card {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .recruit-card .card-body {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        .recruit-card .card-title a {
            color: var(--text-primary);
            text-decoration: none;
        }
        .recruit-card .card-title a:hover {
            color: var(--brand-primary);
        }
    </style>
    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                
                <div class="text-center mb-4">
                    <h2 class="fw-bold fs-2">팀 모집</h2>
                    <p class="text-secondary">함께 성장하고 프로젝트를 완성할 최고의 팀원을 찾아보세요.</p>
                </div>

                <div class="card">
                    <div class="card-body p-4">
                        <div class="d-flex justify-content-end mb-4" th:if="${loginId != null}">
                            <a th:href="@{addTeamRecruit}" class="btn btn-primary">
                                <i class="bi bi-pencil-square me-2"></i>새 팀원 모집하기
                            </a>
                        </div>
                        
                        <div class="row g-4">
                            <div class="col-lg-6" th:each="teamRecruit : ${bList}">
                                <div class="card recruit-card h-100">
                                    <div class="card-body p-4">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <span class="badge text-bg-secondary">[[${teamRecruit.recruitTypeName}]]</span>
                                            <div>
                                                <span th:if="${teamRecruit.statusName == '모집중'}" class="badge bg-success">[[${teamRecruit.statusName}]]</span>
                                                <span th:if="${teamRecruit.statusName != '모집중'}" class="badge text-bg-light border">[[${teamRecruit.statusName}]]</span>
                                            </div>
                                        </div>
                                        <h4 class="card-title h5 mt-2">
                                            <a th:href="@{teamRecruitDetail(recruitId=${teamRecruit.recruitId}, pageNum=${currentPage})}" class="fw-bold">
                                                [[${teamRecruit.title}]]
                                            </a>
                                        </h4>
                                        <div class="mt-auto">
                                            <div class="d-flex justify-content-between align-items-center pt-3 border-top text-secondary small">
                                                <span>
                                                    <i class="bi bi-person-fill me-1"></i>
                                                    <span th:text="${teamRecruit.nickname}"></span>
                                                </span>
                                                <span>
                                                    <i class="bi bi-calendar-event me-1"></i>
                                                    <span th:text="${#temporals.format(teamRecruit.regDate, 'yyyy-MM-dd')}"></span>
                                                </span>
                                                <span>
                                                    <i class="bi bi-eye-fill me-1"></i>
                                                    <span th:text="${teamRecruit.viewCount}"></span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div th:if="${#lists.isEmpty(bList)}" class="col-12">
                                <div class="text-center p-5 bg-light rounded">
                                    <p class="text-secondary mb-0">게시글이 존재하지 않습니다.</p>
                                </div>
                            </div>
                        </div>

                        <div th:if="${not #lists.isEmpty(bList)}" class="mt-5">
                            <nav aria-label="Page navigation">
                                <ul class="pagination justify-content-center mb-0">
                                    <li class="page-item" th:if="${startPage > pageGroup}">
                                        <a class="page-link" th:href="@{/teamRecruitList(pageNum=${startPage - 1}, type=${type}, keyword=${keyword})}">이전</a>
                                    </li>
                                    <li class="page-item" th:each="num : ${#numbers.sequence(startPage, endPage)}" th:classappend="${num == currentPage} ? 'active'">
                                        <a class="page-link" th:if="${num != currentPage}" th:href="@{/teamRecruitList(pageNum=${num}, type=${type}, keyword=${keyword})}" th:text="${num}"></a>
                                        <span class="page-link" th:if="${num == currentPage}" th:text="${num}"></span>
                                    </li>
                                    <li class="page-item" th:if="${endPage < pageCount}">
                                        <a class="page-link" th:href="@{/teamRecruitList(pageNum=${startPage + pageGroup}, type=${type}, keyword=${keyword})}">다음</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>

                    <div class="card-footer p-3">
                        <form name="searchForm" id="searchForm" th:action="@{/teamRecruitList}" method="get" class="d-flex justify-content-center flex-wrap gap-2">
                            <div>
                                <select name="type" class="form-select" style="width: 150px;">
                                    <option value="title" th:selected="${type == 'title'}">제목</option>
                                    <option value="userId" th:selected="${type == 'userId'}">작성자</option>
                                    <option value="content" th:selected="${type == 'content'}">내용</option>
                                    <option value="recruitType" th:selected="${type == 'recruitType'}">모집 분류</option>
                                    <option value="status" th:selected="${type == 'status'}">모집 상태</option>
                                    <option value="techStack" th:selected="${type == 'techStack'}">기술 스택</option>
                                </select>
                            </div>
                            <div class="flex-grow-1" style="min-width: 200px;">
                                <input type="text" name="keyword" class="form-control" th:value="${keyword}"/>
                            </div>
                            <div>
                                <button type="submit" class="btn btn-primary">검색</button>
                            </div>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
</html>