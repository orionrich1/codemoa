<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/default_layout}">

<div layout:fragment="content">
	<style>
		/* 답안 입력창을 코드 에디터처럼 보이게 하는 스타일 */
		.code-editor-textarea {
			font-family: 'D2Coding', monospace; /* 코딩용 고정폭 글꼴 */
			color: #abb2bf; /* 밝은 텍스트 */
			border: none;
			border-radius: var(--border-radius-md);
			height: 100%;
			resize: none;
		}
	</style>
	
	<div class="container my-5">
		<div class="text-center mb-4">
			<h2 class="fw-bold fs-2">문제 풀기</h2>
			<div class="d-none" id="hint">[[${problem.hint}]]</div>
		</div>

		<div class="row g-4">
			<div class="col-lg-6">
				<div class="card h-100">
					<div class="card-body d-flex flex-column p-4">
						<div class="border-bottom pb-3 mb-3">
							<div class="d-flex justify-content-between align-items-center mb-2">
								<span class="badge text-bg-dark fs-6">[[${problem.category}]]</span>
								<span th:if="${problem.difficulty == '상'}" class="badge bg-danger fs-6">상</span>
								<span th:if="${problem.difficulty == '중'}" class="badge bg-warning text-dark fs-6">중</span>
								<span th:if="${problem.difficulty == '하'}" class="badge bg-success fs-6">하</span>
							</div>
							<h4 class="card-title">[[${problem.title}]]</h4>
						</div>
						
						<div class="flex-grow-1" style="overflow-y: auto;">
							<p class="fw-bold">문제 내용</p>
							<pre class="bg-light p-3 rounded" th:text="${problem.content}" style="white-space: pre-wrap;"></pre>
						</div>

						<div class="mt-3 text-end">
							<button type="button" class="btn btn-sm btn-outline-secondary" id="showHintBtn">
								<i class="bi bi-lightbulb-fill me-1"></i> 힌트 보기
							</button>
						</div>
					</div>
				</div>
			</div>

			<div class="col-lg-6">
				<div class="card h-100">
					<form id="problemForm" method="post" th:action="@{problemResult}" class="d-flex flex-column h-100">
						<input type="hidden" name="no" th:value="${problem.problemId}">
						<div class="card-body d-flex flex-column p-4">
							<label for="answer" class="form-label fw-bold">답안 입력</label>
							<textarea id="answer" name="answer" class="form-control useTabkey code-editor-textarea flex-grow-1"
								placeholder="답안을 여기에 입력하세요..."></textarea>
						</div>
						<div class="card-footer d-flex justify-content-end gap-2 p-3">
							<button type="button" class="btn btn-secondary" onclick="location.href='/problems'">돌아가기</button>
							<button type="submit" class="btn btn-primary">제출</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div class="row text-center mt-4" sec:authorize="hasRole('ROLE_ADMIN')">
			<div class="col d-flex justify-content-center gap-2">
				<button type="button" class="btn btn-warning" th:onclick="|location.href='@{problemUpdate(no=${problem.problemId})}'|">수정</button>
				<button type="button" class="btn btn-danger" th:onclick="|location.href='@{problemDelete(no=${problem.problemId})}'|">삭제</button>
			</div>
		</div>
	</div>
	
	<script th:src="@{/js/problem.js}"></script>
</div>
</html>